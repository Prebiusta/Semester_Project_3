@page "/projects"
@using System.Text.Json.Serialization
@using Newtonsoft.Json

<h1>Projects</h1>

<div class="row">
    <div class="structure">
        <div class="create_project">
            <h3>Create New Project</h3>
            <button id="create" class="w3-button w3-xlarge w3-black w3-card-4">+</button>
        </div>
        @if (projects == null)
        {
            <p><em>Loading...</em></p>
        }
        else
        {
            @foreach (var item in projects) {
                <div class="project">
                    <h1>@item.Name</h1>
                    <div class="buttonContainer">
                        <button class="example_c">Sprints</button>
                        <button class="example_c">Product Backlog</button>
                        <div class="break"> </div>
                        <button class="example_c">Burndown Chart</button>
                        <button class="example_c">Edit Project</button>
                        <div class="break"> </div>

                        <button class="example_c">Leave Project</button>
                    </div>
                </div>
            }
        }
    </div>
</div>

@code {
    private Project[] projects;
    private HttpClient Http = new HttpClient();

    protected override async Task OnInitializedAsync()
    {
        var json = await Http.GetStringAsync("http://localhost:6969/api/project?username=David");
        projects = JsonConvert.DeserializeObject<Project[]>(json);
    }

    public class Project
    {
        [JsonPropertyName("projectId")]
        public int ProjectId { get; set; }

        [JsonPropertyName("name")]
        public string Name { get; set; }

        [JsonPropertyName("status")]
        public string Status { get; set; }
    }
}
